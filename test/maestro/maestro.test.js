"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const maestro_class_1 = require("../../dist/maestro/maestro.class");
const chai_1 = require("chai");
const container_class_1 = require("../../dist/container/container.class");
const controller_class_1 = require("../../dist/controller/controller.class");
const MockedAdapter_1 = require("../mock/adapter/MockedAdapter");
describe('Maestro', () => {
    let maestro;
    let controller;
    let container;
    beforeEach(() => {
        maestro = new maestro_class_1.Maestro();
        container = new class extends container_class_1.Container {
            constructor() {
                super(...arguments);
                this.baseURL = '';
            }
        };
        controller = new class extends controller_class_1.Controller {
            constructor() {
                super(...arguments);
                this.baseURL = '';
            }
        };
    });
    it('Is created empty', () => {
        chai_1.expect(maestro.allRoutes().length).eq(0);
        chai_1.expect(maestro.containers().length).eq(0);
        chai_1.expect(maestro.controllers().length).eq(0);
    });
    it('Add containers', () => {
        maestro.add(container);
        chai_1.expect(maestro.containers().length).eq(1);
    });
    it('Remove containers', () => {
        maestro.add(container);
        chai_1.expect(maestro.containers().length).eq(1);
        maestro.removeChildContainer(container);
        chai_1.expect(maestro.containers().length).eq(0);
    });
    it('Add controllers', () => {
        maestro.add(controller);
        chai_1.expect(maestro.controllers().length).eq(1);
    });
    it('Remove controllers', () => {
        maestro.add(controller);
        chai_1.expect(maestro.controllers().length).eq(1);
        maestro.removeController(controller);
        chai_1.expect(maestro.controllers().length).eq(0);
    });
    it('Add adapters', () => {
        const adapter = new MockedAdapter_1.MockedAdapter;
        maestro.addAdapter(adapter);
        chai_1.expect(Object.values(maestro.adapters).length).eq(1);
    });
    it('Remove adapters', () => {
        const adapter = new MockedAdapter_1.MockedAdapter;
        maestro.addAdapter(adapter);
        chai_1.expect(Object.values(maestro.adapters).length).eq(1);
        delete maestro.adapters[adapter.name];
        chai_1.expect(Object.values(maestro.adapters).length).eq(0);
    });
    it('Inherit routes from container', () => {
        controller.resolve = () => { };
        container.allRoutes = () => {
            const routes = [{
                    url: 'mock',
                    methods: 'get',
                    controller,
                    resolver: controller.resolve,
                    requestProxies: [],
                    responseProxies: []
                }];
            return routes;
        };
        maestro.use(container);
        chai_1.expect(maestro.allRoutes().length).eq(1);
    });
    it('Inherit routes from controller', () => {
        controller.resolve = () => { };
        controller.allRoutes = () => {
            const routes = [{
                    url: 'mock',
                    methods: 'get',
                    controller,
                    resolver: controller.resolve,
                    requestProxies: [],
                    responseProxies: []
                }];
            return routes;
        };
        // By inheriting from container
        it('indirectly from container', () => {
            container.addController(controller);
            maestro.use(container);
            chai_1.expect(maestro.allRoutes().length).eq(1);
            maestro.removeChildContainer(container);
            maestro.deleteCachedRoutes();
        });
        // By directling adding it
        it('directly adding to maestro', () => {
            chai_1.expect(maestro.allRoutes().length).eq(0);
            maestro.deleteCachedRoutes();
            maestro.use(controller);
            chai_1.expect(maestro.allRoutes().length).eq(1);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFlc3Ryby50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibWFlc3Ryby50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsb0VBQTJEO0FBQzNELCtCQUE4QjtBQUM5QiwwRUFBaUU7QUFDakUsNkVBQW9FO0FBRXBFLGlFQUE4RDtBQUc5RCxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtJQUV2QixJQUFJLE9BQWdCLENBQUM7SUFDckIsSUFBSSxVQUFpRCxDQUFDO0lBQ3RELElBQUksU0FBK0MsQ0FBQztJQUVwRCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsT0FBTyxHQUFHLElBQUksdUJBQU8sRUFBRSxDQUFDO1FBQ3hCLFNBQVMsR0FBRyxJQUFJLEtBQU0sU0FBUSwyQkFBUztZQUF2Qjs7Z0JBQ2QsWUFBTyxHQUFHLEVBQUUsQ0FBQztZQUdmLENBQUM7U0FBQSxDQUFDO1FBQ0YsVUFBVSxHQUFHLElBQUksS0FBTSxTQUFRLDZCQUFVO1lBQXhCOztnQkFDZixZQUFPLEdBQUcsRUFBRSxDQUFDO1lBRWYsQ0FBQztTQUFBLENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7UUFFMUIsYUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsYUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUMsYUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFN0MsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO1FBRXhCLE9BQU8sQ0FBQyxHQUFHLENBQUMs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RTtZQUNwQyxhQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztZQUM3QixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3hCLGFBQU0sQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FBQyxDQUFDO0lBRUwsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1hZXN0cm8gfSBmcm9tICcuLi8uLi9kaXN0L21hZXN0cm8vbWFlc3Ryby5jbGFzcyc7XHJcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknO1xyXG5pbXBvcnQgeyBDb250YWluZXIgfSBmcm9tICcuLi8uLi9kaXN0L2NvbnRhaW5lci9jb250YWluZXIuY2xhc3MnO1xyXG5pbXBvcnQgeyBDb250cm9sbGVyIH0gZnJvbSAnLi4vLi4vZGlzdC9jb250cm9sbGVyL2NvbnRyb2xsZXIuY2xhc3MnO1xyXG5pbXBvcnQgdHlwZSB7IElBZGFwdGVyIH0gZnJvbSAnLi4vLi4vZGlzdC9hZGFwdGVyL2FkYXB0ZXIudHlwZSc7XHJcbmltcG9ydCB7IE1vY2tlZEFkYXB0ZXIgfSBmcm9tICcuLi9tb2NrL2FkYXB0ZXIvTW9ja2VkQWRhcHRlcic7XHJcbmltcG9ydCB0eXBlIHsgSVByb3hpZWRSb3V0ZSB9IGZyb20gJy4uLy4uL2Rpc3QvcHJveHkvcHJveGllZF9yb3V0ZS50eXBlJztcclxuXHJcbmRlc2NyaWJlKCdNYWVzdHJvJywgKCkgPT4ge1xyXG5cclxuICBsZXQgbWFlc3RybzogTWFlc3RybztcclxuICBsZXQgY29udHJvbGxlcjogQ29udHJvbGxlciAmIHsgW25hbWU6IHN0cmluZ106IGFueTsgfTtcclxuICBsZXQgY29udGFpbmVyOiBDb250YWluZXIgJiB7IFtuYW1lOiBzdHJpbmddOiBhbnk7IH07XHJcblxyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgbWFlc3RybyA9IG5ldyBNYWVzdHJvKCk7XHJcbiAgICBjb250YWluZXIgPSBuZXcgY2xhc3MgZXh0ZW5kcyBDb250YWluZXIge1xyXG4gICAgICBiYXNlVVJMID0gJyc7XHJcbiAgICAgIFtuYW1lOiBzdHJpbmddOiBhbnk7XHJcblxyXG4gICAgfTtcclxuICAgIGNvbnRyb2xsZXIgPSBuZXcgY2xhc3MgZXh0ZW5kcyBDb250cm9sbGVyIHtcclxuICAgICAgYmFzZVVSTCA9ICcnO1xyXG4gICAgICBbbmFtZTogc3RyaW5nXTogYW55O1xyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ0lzIGNyZWF0ZWQgZW1wdHknLCAoKSA9PiB7XHJcblxyXG4gICAgZXhwZWN0KG1hZXN0cm8uYWxsUm91dGVzKCkubGVuZ3RoKS5lcSgwKTtcclxuICAgIGV4cGVjdChtYWVzdHJvLmNvbnRhaW5lcnMoKS5sZW5ndGgpLmVxKDApO1xyXG4gICAgZXhwZWN0KG1hZXN0cm8uY29udHJvbGxlcnMoKS5sZW5ndGgpLmVxKDApO1xyXG5cclxuICB9KTtcclxuXHJcbiAgaXQoJ0FkZCBjb250YWluZXJzJywgKCkgPT4ge1xyXG5cclxuICAgIG1hZXN0cm8uYWRkKGNvbnRhaW5lcik7XHJcbiAgICBleHBlY3QobWFlc3Ryby5jb250YWluZXJzKCkubGVuZ3RoKS5lcSgxKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gIGl0KCdSZW1vdmUgY29udGFpbmVycycsICgpID0+IHtcclxuXHJcbiAgICBtYWVzdHJvLmFkZChjb250YWluZXIpO1xyXG4gICAgZXhwZWN0KG1hZXN0cm8uY29udGFpbmVycygpLmxlbmd0aCkuZXEoMSk7XHJcblxyXG4gICAgbWFlc3Ryby5yZW1vdmVDaGlsZENvbnRhaW5lcihjb250YWluZXIpO1xyXG4gICAgZXhwZWN0KG1hZXN0cm8uY29udGFpbmVycygpLmxlbmd0aCkuZXEoMCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdBZGQgY29udHJvbGxlcnMnLCAoKSA9PiB7XHJcblxyXG4gICAgbWFlc3Ryby5hZGQoY29udHJvbGxlcik7XHJcbiAgICBleHBlY3QobWFlc3Ryby5jb250cm9sbGVycygpLmxlbmd0aCkuZXEoMSk7XHJcblxyXG4gIH0pO1xyXG5cclxuICBpdCgnUmVtb3ZlIGNvbnRyb2xsZXJzJywgKCkgPT4ge1xyXG5cclxuICAgIG1hZXN0cm8uYWRkKGNvbnRyb2xsZXIpO1xyXG4gICAgZXhwZWN0KG1hZXN0cm8uY29udHJvbGxlcnMoKS5sZW5ndGgpLmVxKDEpO1xyXG5cclxuICAgIG1hZXN0cm8ucmVtb3ZlQ29udHJvbGxlcihjb250cm9sbGVyKTtcclxuICAgIGV4cGVjdChtYWVzdHJvLmNvbnRyb2xsZXJzKCkubGVuZ3RoKS5lcSgwKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ0FkZCBhZGFwdGVycycsICgpID0+IHtcclxuXHJcbiAgICBjb25zdCBhZGFwdGVyOiBJQWRhcHRlciA9IG5ldyBNb2NrZWRBZGFwdGVyO1xyXG5cclxuICAgIG1hZXN0cm8uYWRkQWRhcHRlcihhZGFwdGVyKTtcclxuXHJcbiAgICBleHBlY3QoT2JqZWN0LnZhbHVlcyhtYWVzdHJvLmFkYXB0ZXJzKS5sZW5ndGgpLmVxKDEpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnUmVtb3ZlIGFkYXB0ZXJzJywgKCkgPT4ge1xyXG4gICAgY29uc3QgYWRhcHRlcjogSUFkYXB0ZXIgPSBuZXcgTW9ja2VkQWRhcHRlcjtcclxuXHJcbiAgICBtYWVzdHJvLmFkZEFkYXB0ZXIoYWRhcHRlcik7XHJcbiAgICBleHBlY3QoT2JqZWN0LnZhbHVlcyhtYWVzdHJvLmFkYXB0ZXJzKS5sZW5ndGgpLmVxKDEpO1xyXG5cclxuICAgIGRlbGV0ZSBtYWVzdHJvLmFkYXB0ZXJzW2FkYXB0ZXIubmFtZV07XHJcblxyXG4gICAgZXhwZWN0KE9iamVjdC52YWx1ZXMobWFlc3Ryby5hZGFwdGVycykubGVuZ3RoKS5lcSgwKTtcclxuXHJcbiAgfSk7XHJcblxyXG4gIGl0KCdJbmhlcml0IHJvdXRlcyBmcm9tIGNvbnRhaW5lcicsICgpID0+IHtcclxuXHJcbiAgICBjb250cm9sbGVyLnJlc29sdmUgPSAoKSA9PiB7IH07XHJcbiAgICBjb250YWluZXIuYWxsUm91dGVzID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCByb3V0ZXM6IElQcm94aWVkUm91dGVbXSA9IFt7XHJcbiAgICAgICAgdXJsOiAnbW9jaycsXHJcbiAgICAgICAgbWV0aG9kczogJ2dldCcsXHJcbiAgICAgICAgY29udHJvbGxlcixcclxuICAgICAgICByZXNvbHZlcjogY29udHJvbGxlci5yZXNvbHZlLFxyXG4gICAgICAgIHJlcXVlc3RQcm94aWVzOiBbXSxcclxuICAgICAgICByZXNwb25zZVByb3hpZXM6IFtdXHJcbiAgICAgIH1dO1xyXG5cclxuICAgICAgcmV0dXJuIHJvdXRlcztcclxuICAgIH1cclxuXHJcbiAgICBtYWVzdHJvLnVzZShjb250YWluZXIpO1xyXG5cclxuICAgIGV4cGVjdChtYWVzdHJvLmFsbFJvdXRlcygpLmxlbmd0aCkuZXEoMSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdJbmhlcml0IHJvdXRlcyBmcm9tIGNvbnRyb2xsZXInLCAoKSA9PiB7XHJcblxyXG4gICAgY29udHJvbGxlci5yZXNvbHZlID0gKCkgPT4geyB9O1xyXG4gICAgY29udHJvbGxlci5hbGxSb3V0ZXMgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJvdXRlczogSVByb3hpZWRSb3V0ZVtdID0gW3tcclxuICAgICAgICB1cmw6ICdtb2NrJyxcclxuICAgICAgICBtZXRob2RzOiAnZ2V0JyxcclxuICAgICAgICBjb250cm9sbGVyLFxyXG4gICAgICAgIHJlc29sdmVyOiBjb250cm9sbGVyLnJlc29sdmUsXHJcbiAgICAgICAgcmVxdWVzdFByb3hpZXM6IFtdLFxyXG4gICAgICAgIHJlc3BvbnNlUHJveGllczogW11cclxuICAgICAgfV07XHJcblxyXG4gICAgICByZXR1cm4gcm91dGVzO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEJ5IGluaGVyaXRpbmcgZnJvbSBjb250YWluZXJcclxuICAgIGl0KCdpbmRpcmVjdGx5IGZyb20gY29udGFpbmVyJywgKCkgPT4ge1xyXG4gICAgICBjb250YWluZXIuYWRkQ29udHJvbGxlcihjb250cm9sbGVyKTtcclxuICAgICAgbWFlc3Ryby51c2UoY29udGFpbmVyKTtcclxuICAgICAgZXhwZWN0KG1hZXN0cm8uYWxsUm91dGVzKCkubGVuZ3RoKS5lcSgxKTtcclxuICAgICAgbWFlc3Ryby5yZW1vdmVDaGlsZENvbnRhaW5lcihjb250YWluZXIpO1xyXG4gICAgICBtYWVzdHJvLmRlbGV0ZUNhY2hlZFJvdXRlcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQnkgZGlyZWN0bGluZyBhZGRpbmcgaXRcclxuICAgIGl0KCdkaXJlY3RseSBhZGRpbmcgdG8gbWFlc3RybycsICgpID0+IHtcclxuICAgICAgZXhwZWN0KG1hZXN0cm8uYWxsUm91dGVzKCkubGVuZ3RoKS5lcSgwKTtcclxuICAgICAgbWFlc3Ryby5kZWxldGVDYWNoZWRSb3V0ZXMoKTtcclxuICAgICAgbWFlc3Ryby51c2UoY29udHJvbGxlcik7XHJcbiAgICAgIGV4cGVjdChtYWVzdHJvLmFsbFJvdXRlcygpLmxlbmd0aCkuZXEoMSk7XHJcbiAgICB9KTtcclxuXHJcbiAgfSk7XHJcbn0pOyJdfQ==